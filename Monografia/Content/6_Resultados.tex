\chapter{Resultados e Discussões}
\label{Resultados}

Com as funcionalidades planejadas para o projeto concluídas, o passo seguinte foi a realização de testes. Esse capítulo será dividido em duas seções tal que na primeira serão tratados dos resultados da extração de informação de imagens, e a segunda, tratará da performance do detector de obstáculos.

\section{Descrição de Imagens}

[tópico incompleto - testes em andamento]

Na descrição de imagens duas variáveis foram consideradas mais importantes para avaliar o desempenho do sistema: o tempo de resposta, pois não é conveniente deixar o usuário esperando por muito tempo pela informação requisitada, e a qualidade dos resultados obtidos, para que o usuário receba aquilo que é esperado do sistema. Como a Google Cloud API é uma ferramenta online, a primeira dificuldade encontrada para eficiência de processamento foi o transporte de dados para o servidor da Google. Quanto mais dados são transmitidos pela rede e processados pela rotina no servidor, maior o tempo de latência para a resposta. Isso significa que a velocidade da Internet do usuário será sempre um limitador. 


\subsection{Teste para diferentes dimensões de imagens}

Por outro lado, a quantidade de dados transmitida é flexível uma vez que a imagem pode ter sua resolução reduzida e exibir um número menor de bytes para ser representada. Entretanto, essa redução resulta em um detalhamento menor da imagem, o que pode dificultar seu processamento, causar erros de interpretação de seu conteúdo e por fim não retornar resultados satisfatórios. Por essa razão, para cada solicitação de extração de informação das imagens, a mesma imagem foi enviada com diversas resoluções, e os tempos das fases do processo foram medidos. A Figura \ref{Teste-HP} foi a imagem capturada para esse fim. Como é possível observar a partir da Tabela \ref{Estat-HP} juntamente com a Figura \ref{Resultado-HP}, a resolução da imagem é proporcional ao tempo total de processamento da informação requisitada e inversamente proporcional a quantidade de erros do resultado. 

\begin{figure}[H]
	\centering
	\includegraphics[scale=0.15]{./Resources/Teste-HP.jpg}
	\caption{Captura de imagem da etiqueta do computador HP para posterior descrição}
	\label{Teste-HP}
	%\caption*{Source: some source}
\end{figure}



\newsavebox\MBox
\newenvironment{MinipageGreen}[1]
{\par\smallskip\begin{lrbox}{\MBox}\begin{minipage}{#1}}
		{\end{minipage}\end{lrbox}%
	\makebox(0,0){\put(0,0){%
			\includegraphics[width=\wd\MBox,height=2\ht\MBox]{./Resources/green.jpg}
			}
	}%
	\usebox\MBox\par%
}
\newenvironment{MinipageRed}[1]
{\par\smallskip\begin{lrbox}{\MBox}\begin{minipage}{#1}}
		{\end{minipage}\end{lrbox}%
	\makebox(0,0){\put(0,0){%
			\includegraphics[width=\wd\MBox,height=2\ht\MBox]{./Resources/red.jpg}
		}
	}%
	\usebox\MBox\par%
}

\newenvironment{MinipageYellow}[1]
{\par\smallskip\begin{lrbox}{\MBox}\begin{minipage}{#1}}
		{\end{minipage}\end{lrbox}%
	\makebox(0,0){\put(0,0){%
			\includegraphics[width=\wd\MBox,height=2\ht\MBox]{./Resources/yellow.jpg}
		}
	}%
	\usebox\MBox\par%
}


\begin{figure}[H]
	
	\begin{subfigure}{.45\textwidth}
		
		
		\begin{MinipageGreen}{\textwidth} 
			
			\definecolor{green}{RGB}{140,255,26}
		%	\definecolor{red}{RGB}{255,71,71}
			
				\bf\color{white} nesta imagem está escrito: \color{pink} shift shift ctrl \color{green} HP 15 Simply perfect. Processing power Do it all at impressive Speeds with a next-generation AMD processor. Free 25GB lifetime cloud \color{red}00X \color{green}storage from Box Get your files from any Internet-connected device. HP TrueVision HD Webcam Capture all the details with vibrant clarity, even in low light. See disclaimers on product box. For complete details and terms of use, including cancellation policies, visit the website at www.box.com, Internet service required and not included. \color{pink}alt
			
		\end{MinipageGreen}
		
		

		
		%\colorbox{dark-purple}{	
		
			%\parbox{.9\textwidth}{
				
				%\begin{verbatim}						
				
					%\color{white} nesta imagem está escrito: \color{pink} shift shift ctrl \color{green} HP 15 Simply perfect. Processing power Do it all at impressive Speeds with a next-generation AMD processor. Free 25GB lifetime cloud \color{red}00X \color{green}storage from Box Get your files from any Internet-connected device. HP TrueVision HD Webcam Capture all the details with vibrant clarity, even in low light. See disclaimers on product box. For complete details and terms of use, including cancellation policies, visit the website at www.box.com, Internet service required and not included. \color{pink}alt
				
				%\end{verbatim}
				

		%	}			
		%}
		
	
		
		\captionof{figure}{}
		\label{RI}
	\end{subfigure}		
	\begin{subfigure}{.45\textwidth}
		
		\begin{MinipageYellow}{\textwidth}
			
			\definecolor{green}{RGB}{0,179,0}
			%\definecolor{red}{RGB}{255,71,71}
			
			\bf\color{white}nesta imagem está escrito: \color{purple}shift ctrl \color{green}HP 15 Simply perfect. Processing \color{red}powe \color{green}Do it all at \color{red}impress peeds \color{green}with a next-generation AMD processor. Free 25GB lifetime cloud storage from Box Get your files from any Internet-connected device. HP True Vision HD Webcam Capture all the details with vibrant clarity, even in low light. See disclaimers on product box. For complete details and terms of use, including cancellation policies, visit the website at www.box.com Internet service required and not included. \color{purple}alt
			
		\end{MinipageYellow}
		
		%\fbox{
		
	%\colorbox{black}{	
			
			%\parbox{.9\textwidth}{			
				%\color{white}nesta imagem está escrito: \color{purple}shift ctrl \color{green}HP 15 Simply perfect. Processing \color{red}powe \color{green}Do it all at \color{red}impress peeds \color{green}with a next-generation AMD processor. Free 25GB lifetime cloud storage from Box Get your files from any Internet-connected device. HP True Vision HD Webcam Capture all the details with vibrant clarity, even in low light. See disclaimers on product box. For complete details and terms of use, including cancellation policies, visit the website at www.box.com Internet service required and not included. \color{purple}alt 
			%}
			
	%}		
		%}
		\captionof{figure}{}
		\label{RII}
	\end{subfigure}		
	\begin{subfigure}{\textwidth}
	%\fbox{
	\vspace{1cm}
	

	\begin{MinipageRed}{\textwidth}
		
		\definecolor{red}{RGB}{255,128,128}
		
		\bf\color{white}nesta imagem está escrito: \color{purple}shift \color{green}HP 15 Simply perfect. Processing \color{red}powR mpress \color{green}next-generation \color{red}ANAL pluce sul \color{green}Free 25GB lifetime \color{red}duud \color{green}storage from Box Get your files \color{red}Ton Jny \color{green}Internet connected \color{red}cevice \color{green}HP \color{red}Tru BVision HU Webo am Copture \color{green}the detais with vibrant \color{red}darity, \color{green}even \color{red}inluw lilli. box for compl-1 use inclue inteinetsarute resu ie: \color{purple}a
		
	\end{MinipageRed}
	
	%\colorbox{black}{
	
						
			%\parbox{\textwidth}{
				

								
				%\color{white}nesta imagem está escrito: \color{purple}shift \color{green}HP 15 Simply perfect. Processing \color{red}powR mpress \color{green}next-generation \color{red}ANAL pluce sul \color{green}Free 25GB lifetime \color{red}duud \color{green}storage from Box Get your files \color{red}Ton Jny \color{green}Internet connected \color{red}cevice \color{green}HP \color{red}Tru BVision HU Webo am Copture \color{green}the detais with vibrant \color{red}darity, \color{green}even \color{red}inluw lilli. box for compl-1 use inclue inteinetsarute resu ie: \color{purple}a
			%}
			
			
			
			
			%}
		%}
		\captionof{figure}{}
		\label{RIII}
	\end{subfigure}	
	\caption{Resultado da extração apenas de texto sobre a imagem da Figura \ref{Teste-HP} com as resoluções de (\protect\subref{RI}) 2560x1920, (\protect\subref{RII}) 1024x768 e (\protect\subref{RIII}) 480x360}
	\label{Resultado-HP}
\end{figure}


 



\begin{table}[H]
	
	\caption{Tempos das fases da transcrição de imagem sobre a etiqueta do computador HP, ilustrada pela Figura \ref{Teste-HP}}	
	
	\begin{tabular}{llll}
		
		Resultado							& Figura \ref{RI} 	& Figura \ref{RII}	& Figura \ref{RIII}\\
		Resolução             	& 2560x1920	    	& 1024x768          & 480x360  	       \\
		
		Tempo de compressão     			    & 3667ms   		& 939ms		    	& 206ms  	       \\
		Tempo de codificação    				& 570ms    	    & 69ms              & 66ms             \\
		Tempo de transferência e processamento	& 103,849s	    & 17,871s           & 8,285s   	       \\
		Tempo de reescrita                	    & 17ms		    & 97ms              & 4ms 	           \\
		
		
	\end{tabular}
	\label{Estat-HP}	
\end{table}


Varias características importantes podem ser extraídas desses resultados. Primeiramente, a imagem possui um defeito causado pelo brilho intenso do flash concentrado num único ponto, no momento da captura e esse defeito afeta diretamente 3 palavras do texto. Essas palavras afetadas pelo brilho correspondem exatamente as malformadas, em vermelho, do resultado apresentado pela Figura \ref{RII}, erro esse que não ocorre com o apresentado pela Figura \ref{RI}. Isso permite a inferência de que a redução da resolução pode ter tornado a OCR menos precisa e esse problema ter sido potencializado pelo brilho do flash ao ponto de distorcer completamente a grafia das palavras. 

É possível que se o brilho refletido não tivesse sobreposto essas palavras, o resultado de \ref{RII} fosse muito semelhante ao de \ref{RI}. Essa hipótese pode ser confirmada pela Tabela \ref{bestPracticesTable}, pois as dimensões recomendadas pela Google para a detecção de texto correspondem as da Figura \ref{RI}. Além disso, dimensões inferiores reduzem a acurácia do resultado, o que pode ser confirmado pela Figura \ref{RIII}, enquanto superiores aumentam o tempo de processamento e uso da largura de banda sem necessariamente promover melhora significativa da acurácia\cite{bestPracticesGoogle}.


\begin{figure}[H]
	\centering
	
	\captionof{table}{Dimensões de imagem recomendadas para cada característica buscada}
	\includegraphics[scale=0.5]{./Resources/bestPractices.png}
	\caption*{Fonte: Google Cloud Platform\cite{bestPracticesGoogle}}

	\label{bestPracticesTable}
	
\end{figure}

\subsection{Teste para reconhecimento de texto girado}

Considerando o fato de que o usuário do aplicativo certamente não saberá de antemão qual a posição do texto do qual deseja obter informações, é possível ocorrer a captura de um texto de cabeça para baixo. Ao se realizar os testes sobre textos com diferentes posições angulares, identificou-se que entre -90° e 90° não há qualquer problema na extração de informação. Entretanto, acima desse limite, a aplicação simplesmente não consegue mais identificar os caracteres corretamente. O resultado obtido pode ser visualizado pela Figura \ref{posicoes}

\begin{figure}[H]
	
	\begin{subfigure}{5cm}
		
		\centering
		\includegraphics[scale=0.4]{./Resources/girado.png}
		\captionof{figure}{}
		\label{girado}
	
	\end{subfigure}		
	\begin{subfigure}{5cm}
		
		\centering
		\includegraphics[scale=0.4]{./Resources/girado90.png}
		\captionof{figure}{}
		\label{girado90}
		
	\end{subfigure}		
	\begin{subfigure}{5cm}

		\centering
		\includegraphics[scale=0.4]{./Resources/semgirar.png}
		\captionof{figure}{}
		\label{semgirar}
		
	\end{subfigure}	
	\caption{Comparação de resultados da extração apenas de texto sobre três diferentes posições de uma imagem. (\protect\subref{girado}) 180°, (\protect\subref{girado90}) 90° e (\protect\subref{semgirar}) 0°}
	\label{posicoes}
\end{figure} 

Apesar de esse resultado mostrar que há uma limitação na capacidade de API reconhecer caracteres, é possível compreender a razão. Uma hipótese é que o algoritmo apenas verifique que há linhas horizontais de textos, e não considere a possibilidade de o texto estar virado em 180°. Então, ele deve comparar o simbolo invertido com os de sua base de dados, e o que se encaixar melhor é considerado o correto. Ao analisar com mais cuidado a Figura \ref{girado}, pode-se perceber que apesar de o texto retornado não ter qualquer significado real, existe uma razão na formação de cada simbolo. Há uma considerável semelhança entre a letra "a" girada de 180° e a letra "e", entre "L" e "1", entre "w" e "m", e assim por diante. Quanto a Figura \ref{girado90}, praticamente não houve erros durante a OCR, mesmo apresentando um texto girado de 90°, assim como o teste apresentado  pela Figura \ref{semgirar}.


\subsection{Teste para reconhecimento de texto com letra cursiva}

Uma das possibilidades de utilização do aplicativo seria a leitura de bilhetes escritos a mão. Alguns testes foram realização para se ter conhecimentos dos limites das capacidades da API, quanto a escrita a mão, seja ela de forma ou cursiva. Os resultados mostraram que existe uma significante limitação da API quanto a identificação de caracteres cursivos. O reconhecimento até ocorre, mas em número extremamente reduzido se comparado à letra de forma, mesmo em traços largos e cor contrastante.


\subsection{Teste para rotulação de elementos da cena}

Saber o que se passa tendo conhecimento do que há ao redor é uma dos objetivos do projeto. Para saber o quais as limitações da API na detecção de objetos em imagens, foram realizados testes apontando a câmera para os mais diversos objetos a fim de se avaliar sua performance nesse quesito. A Figura \ref{dogLabels} apresenta o resultado completo retornado pela extração de rótulos da imagem de um cachorro. É possível perceber que características como "Cachorro de brinquedo" e "Yorkshire Terrier" não são aplicáveis ao animal da foto. Como o aplicativo só considera resultados com pontuação acima de 80\%, rótulos como esses, em vermelho, foram ignorados no resultado visualizado pelo usuário.

\iffalse
\begin{table}[H]
	
	\centering
	
	\caption{Tempos das fases da transcrição de imagem sobre a etiqueta do computador HP, ilustrada pela Figura \ref{Teste-HP}}	
	
	\begin{tabular}{ll}
		
		Atributo				& Pontuação \\
		Animal de estimação    	& 95\% \\		
		Cachorro		        & 94\% \\
		Animal    	            & 93\% \\
		Mamífero			    & 90\%      \\
		Cachorro de brinquedo   & 70\%	          \\
		Carnívoro      			& 68\%	          \\
		Yorkshire Terrier		& 52\%	          \\
	\end{tabular}
	\label{cachorro}	
\end{table}

\fi

\begin{figure}[H]
	\centering	
	\includegraphics[scale=0.5]{./Resources/labels.png}
	\captionof{figure}{Rótulos extraídos da imagem de um cachorro}
	\label{dogLabels}
	
\end{figure}

A escolha do valor mínimo de pontos para que cada rótulo fosse aceito foi puramente empírica. Apesar de ter resultado em boa descrição para a imagem da Figura \ref{dogLabels}, o valor escolhido que elimina alguns resultados subaproveitou os rótulos da imagem da Figura \ref{computerLabel}, descrevendo-a apenas como "Dispositivo", já que "Laptop", palavra mais adequada, foi ignorada.

\begin{figure}[H]
	\centering	
	\includegraphics[scale=0.4]{./Resources/labelsComputer.png}
	\captionof{figure}{Primeira extração de rótulos da imagem de um laptop}
	\label{computerLabel}
	
\end{figure}

A definição de um valor que simultaneamente seja capaz de descrever um elemento da cena e não sobrecarregue o usuário com informações, muitas vezes desnecessárias, não é tão simples, e uma descrição curta e detalhada dificilmente será conseguida. No entanto, o resultado não depende apenas da definição desse valor, mas também da própria imagem. A Figura \ref{computerLabel2} ilustra o mesmo laptop capturado novamente sob iluminação e posição diferentes. Nesse cenário, o resultado foi capaz de promover uma descrição mais detalhada do objeto em cena.

\begin{figure}[H]
	\centering	
	\includegraphics[scale=0.4]{./Resources/labelsComputer2.png}
	\captionof{figure}{Segunda extração de rótulos da imagem de um laptop}
	\label{computerLabel2}
	
\end{figure}

Nos casos citados, independentemente de qual foi o critério para ignorar alguns resultados, todos os rótulos quase sempre tiveram relação com o objeto na imagem. Entretanto, em algumas situações a API falhou em identificar ao menos um rótulo corretamente para a imagem capturada. A Figura \ref{cadeiraLabel} ilustra esse problema. Nela, foi capturada a imagem de uma cadeira, porém além de não haver resultados acima do limite mínimo de pontuação, nenhum dos quatro rótulos tem qualquer relação com a imagem.

\begin{figure}[H]
	\centering	
	\includegraphics[scale=0.4]{./Resources/labelCadeira.png}
	\captionof{figure}{Extração de rótulos da imagem de um cadeira}
	\label{cadeiraLabel}
	
\end{figure}

É possível que a explicação para esse resultado seja que o ambiente no qual a cadeira estava inserida tivesse afetado sua imagem capturada ao ponto de a API não ser capaz de identificar o que estava de fato em cena, e confundir o objeto com o para-choques de um veículo. Obviamente não é desejável que confusões como essa ocorram, entretanto, esse é um fenômeno comum mesmo ao olho humano, conhecido como "ilusão de óptica". Ao analisar a imagem, as faixas escuras entre a parede e o chão, atrás da cadeira, somadas a estrutura em grades do própria do objeto podem ter sido avaliados como a parte frontal de um carro: Dois faróis e com para-choques no meio.

\subsection{Teste para classificação de expressão facial}



\raggedright
\section{Detecção de Obstáculos} 
[tópico apenas iniciado - faltam testes]

Na detecção de obstáculos, duas variáveis foram consideradas para o desenvolvimento e desempenho do sistema. Primeiramente, como havia a necessidade da criação de um circuito externo, o custo benefício foi analisado. Foi necessária a utilização de um Arduíno, um sensor de obstáculos, e um módulo de comunicação. O Arduíno em termos de capacidade de processamento se mostrou adequado  para a tarefa, que necessitava de baixíssimo poder computacional: leitura de sinais e encaminhamento de dados. O sensor de obstáculos por ter uma abrangência de 4 metros, mostrou ser aplicável para o propósito do projeto por fornecer margem suficiente de tempo de reação de um usuário caminhando [velocidade de caminhada, tempo de reação audição, tato, limite do sensor = 4m]. O módulo bluetooth utilizado também foi adequado, considerando que trata-se de dispositivos muito próximos em comunicação. O segundo problema encontrado foi o tamanho dos elementos do circuito. Quanto menor, mais discreto e mais adaptável ao corpo ele se torna, o que não foi plenamente atingido [o circuito é um pouco maior que um smartphone].



